<div class="loading" *ngIf="!allCeil">
    <h5>loading...</h5>
</div>
<div class="week-schedule-container" *ngIf="allCeil">
    <div class="selected-range">
        <h2>{{ displayedDays[0] | date: 'dd MMMM' }} - {{ displayedDays[displayedDays.length - 1] | date: 'dd MMMM, yyyy' }}</h2>
        <div class="btn">
            <button mat-raised-button color="accent" (click)="addNewTask()">New task</button>
        </div>
    </div>
    <div class="table">
        <div>
            <div class="empty-block"></div>
            <div class="time-block" [ngStyle]="{ 'grid-template-rows': 'repeat(' + workingHours.length + ', 1fr)' }">
                <div class="time" *ngFor="let time of workingHours">
                    <span>{{ time }}</span>
                </div>
            </div>
        </div>
        <div class="schedule">
            <div class="date-block">
                <div
                    class="day"
                    *ngFor="let day of displayedDays; let i = index"
                    [ngClass]="{ selected: i === numberOfSelectedDay }">
                    <span>{{ day | date: 'EE, dd MMM' }}</span>
                </div>
            </div>
            <div class="ceil-block">
                <div class="grid" *ngFor="let day of allCeil; let i = index"
                    [ngClass]="{ selected: i === numberOfSelectedDay }"
                    [ngStyle]="{
                        'grid-template-rows': 'repeat(' + workingHours.length + ', 1fr)'
                    }">
                    <div class="day-in-ceil-block" *ngFor="let hour of workingHours">
                        <div class="ceil" (click)="addNewTask(day, hour)"></div>
                    </div>
                    <!-- <div class="tasks-block"> -->
                        <div class="task" *ngFor="let task of day.tasks"
                            (click)="showTaskInfo(task.info)"
                            [ngStyle]="{ 
                                'grid-row': task.rowStart + '/' + task.rowEnd,
                                'grid-column': task.subcolumnStart + '/' + task.subcolumnEnd }">
                            <p>{{ task.info.title }}</p>
                        </div>
                    <!-- </div> -->
                </div>
            </div>
        </div>
    </div>
</div>
